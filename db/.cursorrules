# Critical Database Rules

[prisma]
forbidden_commands = [
    "prisma migrate reset",  # BREAKS Supabase permissions
    "prisma migrate dev"     # Uses reset internally, BREAKS Supabase permissions
]

[reason]
description = """
NEVER use Prisma reset or migrate dev commands with Supabase!
These commands use RESET which destroys:
- RLS policies
- Custom roles
- Permission settings
- Auth system configuration
"""

[allowed]
commands = [
    "psql $DATABASE_URL -f db/migrations/*.sql",  # Direct SQL migrations
    "npm run migrate",                            # Safe migration script
    "npm run seed",                               # Safe seeding
    "npm run seed:force"                          # Uses SQL reset + seed
]

[local_only]
commands = [
    "npm run db:start",   # Docker DB
    "npm run db:stop",    # Docker DB
    "npm run db:reset"    # Safe for local Docker only
] 